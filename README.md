> **用于在线管理PHP程序，Java配置的在线工具。可对代码进行多集群同步、重启等操作。**

账号，密码请自行设置。

### 特点
1. 使用PHP自带的web服务器。
2. 使用Sqlite数据库（Linux自带）。
3. 可查看每条语句的执行记录
4. 独立部署，无需**其他依赖**。
使用时，仅需要在服务器中配置免登陆（方便执行SSH 远程命令执行， Rsync 数据同步）、配置php-fpm、hhvm 系统服务。


### 初始化项目
#### 初始化环境依赖
在项目目录下执行： `composer update`， 将项目依赖的twig库添加到vendor中。
#### 初始化数据库
在项目目录下执行： `sh bin/createDB.sh`， 初始化存储的数据库。
#### 启动服务
在项目目录下执行： `sh bin/startServer.sh`, 启动web服务。

>在启动服务后，可在浏览器中访问所在机器的9999端口

### 集群管理
#### 操作
通过访问ip:9999/cluster/index，可进行集群的添加、删除、修改操作。
#### 注意事项
1. ip列表，尽量按照逗号、回车分割，*ip地址中间不能呢出现空格*。
2. 对进群ip的更新，将删除原有的所有ip，并将新设置的ip添加。

### 执行记录查看
#### 操作
每次对机器的执行记录，将会记录批处理的id，执行的时间，执行人的ip，执行的ip，执行的shell脚本，以及执行的结果记录。
#### 注意事项
查看详细信息，需要在记录中点开查看。

### 运维管理
#### 添加一个项目
1. 将需要管理的项目，拷贝到**项目目录/storage/file-list/** 目录下
2. 在配置文件config/simple.php 文件中的syncDirs字段添加相应配置。

  对于 **PHP 或者 hhvm 项目**，则需要添加name(项目名称)、path(在file-list目录的文件夹名称)、dstPath(在目标文件夹中所对应的位置)、项目类型（php ， hhvm 或者 Java；用于项目重启）;
  对于 **Java 项目**, 需要添加name(项目名称)、path(在file-list目录的文件夹名称)、dstPath(在目标文件夹中所对应的位置)、项目类型（php 或者 Java；用于项目重启）、processName(进程名称), jobPath（java 代码的根目录，用于Java作业的重启）;

#### 操作
1. 打开 ip:9999/deploy/index ，在右侧可看到file-list目录下的所有文件，选择需要修改的文件
2. 选择要同步的集群
3. 点击上传配置。
	a. 对于PHP 文件，将于通过`php -l {changed-file}` 做语法检查，若语法检查不通过，则不能进行上传文件操作
	b. 将保持原文件的用户组、访问权限。
4. 点击同步配置，对上传后的文件进行文件同步。(对于未存在的目录，将增加对应目录)
5. 点击重启进程。
	**对于PHP项目**，将执行`service php-fpm restart`  命令；
	**对于HHVM项目**， 将执行`service hhvm restart` 命令；
	**对于JAVA项目**，将首先kill相应进程，进而执行`nohup java -jar {jobName} 2>&1 1>/dev/null &` 命令
6. 点击查看结果，则跳转到执行记录查看页面。
